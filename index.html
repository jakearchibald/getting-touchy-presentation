<!DOCTYPE HTML>
<html lang="en">
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=792, user-scalable=no">
    <meta http-equiv="x-ua-compatible" content="ie=edge">
    <title>Getting touchy - an introduction to touch and pointer events / Patrick H. Lauke</title>
    <link rel="stylesheet" href="shower/themes/redux/styles/screen.css">
    <link rel="stylesheet" href="shower/themes/redux/styles/overrides.css">
    <link rel="stylesheet" href="highlight/styles/sunburst.css">
    <style>
        #yougotthetouch.slide { background-color: #000; }
        .strike { text-decoration: line-through; }
    </style>
    <script src="highlight/highlight.pack.js"></script>
    <script>hljs.initHighlightingOnLoad();</script>
</head>
<body class="shower list">
<header class="caption">
    <h1>Getting touchy</h1>
    <p>An introduction to touch and pointer events</p>
</header>

<!-- -->

<section class="slide cover title" id="Cover"><div>
    <div class="titlestrap">
        <h2>Getting <strong>touchy</strong></h2>
        <p>An introduction to <strong>touch and pointer</strong> events</p>
    </div>
    <p class="info">Patrick H. Lauke / Frontend NE / 2 March 2017</p>
    <img src="pictures/backgrounds/background-cover.jpg" alt="" class="cover">
</div></section>

<!-- -->

<section class="slide listing"><div>
    <h2>about me...</h2>
    <ul>
    <li>senior accessibility consultant at <a target="_blank" href="https://www.paciellogroup.com/">The Paciello Group</a></li>
    <li>previously developer relations at <a target="_blank" href="http://www.opera.com/">Opera</a></li>
    <li>co-editor <a target="_blank" href="https://w3c.github.io/touch-events/">Touch Events Level 2</a></li>
    <li>WG chair and co-editor <a target="_blank" href="https://w3c.github.io/pointerevents/">Pointer Events Level 2</a></li>
    </ul>
</div></section>

<!-- -->

<section class="slide"><div>
    <img src="pictures/sites/github-patrickhlauke-getting-touchy.png" alt="">
    <p><a target="_blank" href="https://github.com/patrickhlauke/getting-touchy-presentation">github.com/patrickhlauke/getting-touchy-presentation</a></p>
    <p>"evergreen" expanded version of this presentation<br><small>(and branches for specific conferences)</small></p>
</div></section>

<!-- -->

<section class="slide"><div>
    <img src="pictures/sites/patrickhlauke.github.io.png" alt="">
    <p><a target="_blank" href="https://patrickhlauke.github.io/touch/">patrickhlauke.github.io/touch</a></p>
</div></section>

<!-- -->

<section class="slide"><div>
    <img src="pictures/backgrounds/photo-device-testing.jpg" alt="Large number of mobile phone/tablet test devices">
</div></section>

<!-- -->

<section class="slide"><div>
    <img src="pictures/sites/patrickhlauke-github-touch-results.png" alt="">
    <p><a target="_blank" href="https://patrickhlauke.github.io/touch/tests/results/">Touch/pointer events test results</a></p>
</div></section>

<!-- -->

<section class="slide cover impact"><div>
    <div><p>my JavaScript sucks...<br><small>(but will hopefully convey the right concepts)</small></p></div>
    <img src="pictures/backgrounds/background-danger-415-volts.jpg" class="cover" alt="">
</div></section>

<!-- -->

<section class="slide impact"><div>
<div>
    <p>“how can I make my website<br>work on <strong>touch devices</strong>?”</p>
</div>
</div></section>

<!-- -->

<section class="slide impact"><div>
<div>
    <p>you <strong>don't</strong> need <strong>touch events</strong><br>browsers <strong>emulate</strong> regular <strong>mouse events</strong></p>
</div>
</div></section>

<!-- -->

<section class="slide"><div>
    <img src="pictures/ios7/event-listener-mouse-before.png" alt="">
    <p><a target="_blank" href="https://patrickhlauke.github.io/touch/tests/event-listener_mouse-only.html">patrickhlauke.github.io/touch/tests/event-listener_mouse-only.html</a></p>
</div></section>

<!-- -->

<section class="slide"><div>
    <img src="pictures/ios7/event-listener-mouse-after.png" alt="">
    <p><a target="_blank" href="https://patrickhlauke.github.io/touch/tests/event-listener_mouse-only.html">patrickhlauke.github.io/touch/tests/event-listener_mouse-only.html</a></p>
</div></section>

<!-- -->

<section class="slide code"><div>
    <h2>compatibility mouse events</h2>
    <pre><code class="json">(mouseenter) > mouseover > mousemove* > mousedown >
(focus) > mouseup > click</code></pre>
    <p><small>* only a single “sacrificial” <code>mousemove</code> event fired</small></p>
</div></section>

<!-- -->

<section class="slide code"><div>
    <h2>on first tap</h2>
    <pre><code class="json">(mouseenter) > mouseover > mousemove >
    mousedown > (focus) > mouseup > click</code></pre>
    <h2>subsequent taps</h2>
    <pre><code class="json">mousemove > mousedown > mouseup > click</code></pre>
    <h2>tapping away</h2>
    <pre><code class="json">(mouseout) > (blur)</code></pre>
    <p><small><code>focus</code>/<code>blur</code> only on focusable elements; subtle differences between browsers</small><br>
    <a target="_blank" href="https://patrickhlauke.github.io/touch/tests/results/#mobile-tablet-touchscreen-events">Mobile/tablet touchscreen activation/tap event order</a></p>
</div></section>

<!-- -->

<section class="slide impact"><div>
<div>
    <p>emulation works,<br>but is <strong>limiting</strong>/<strong>problematic</strong></p>
</div>
</div></section>

<!-- -->

<section class="slide statement listing"><div>
<div>
    <ol>
        <li>delayed event dispatch</li>
        <li>mousemove doesn't track</li>
    </ol>
</div>
</div></section>

<!-- -->

<section class="slide statement listing"><div>
<div>
    <ol>
        <li><strong>delayed event dispatch</strong></li>
        <li>mousemove doesn't track</li>
    </ol>
</div>
</div></section>

<!-- -->

<section class="slide"><div>
    <img src="pictures/ios7/event-listener-show-delay-before.png" alt="">
    <p><a target="_blank" href="https://patrickhlauke.github.io/touch/tests/event-listener_show-delay.html">patrickhlauke.github.io/touch/tests/event-listener_show-delay.html</a></p>
    <p><small>less of a problem in modern browsers, but for <strong>iOS < 9.3 or older Androids</strong> still relevant</small></p>
</div></section>

<!-- -->

<section class="slide"><div>
    <img src="pictures/ios7/event-listener-show-delay-after.png" alt="">
    <p><a target="_blank" href="https://patrickhlauke.github.io/touch/tests/event-listener_show-delay.html">patrickhlauke.github.io/touch/tests/event-listener_show-delay.html</a></p>
</div></section>

<!-- -->

<section class="slide statement listing"><div>
<div>
    <ol>
        <li>delayed event dispatch</li>
        <li><strong>mousemove doesn't track</strong></li>
    </ol>
</div>
</div></section>

<!-- -->

<section class="slide"><div>
    <img src="pictures/win8/chrome-particle-party.png" alt="">
    <p><a target="_blank" href="https://patrickhlauke.github.io/touch/particle/2">patrickhlauke.github.io/touch/particle/2</a></p>
</div></section>

<!-- -->

<section class="slide"><div>
    <img src="pictures/android/chrome-particle-party-mouse-only.png" alt="">
    <p><a target="_blank" href="https://patrickhlauke.github.io/touch/particle/2">patrickhlauke.github.io/touch/particle/2</a></p>
</div></section>

<!-- -->

<section class="slide impact"><div>
<div>
    <p>“we need to go deeper...”</p>
</div>
</div></section>

<!-- -->

<section class="slide statement"><div>
<div>
    <h2>touch events</h2>
    <p>introduced by Apple, adopted in Chrome/Firefox/Opera</p>
    <p><small>(and belatedly IE/Edge – more on that later)</small></p>
    <p><a target="_blank" href="http://www.w3.org/TR/touch-events">www.w3.org/TR/touch-events</a></p>
</div>
</div></section>

<!-- -->

<section class="slide"><div>
    <img src="pictures/sites/caniuse-touch-events-current.png" alt="">
    <p><a target="_blank" href="http://caniuse.com/#search=touch%20events">caniuse.com: Can I use <strong>touch events</strong>?</a></p>
</div></section>

<!-- -->

<section class="slide statement"><div>
<div>
    <p><code class="json">touchstart<br>
touchmove<br>
touchend<br>
touchcancel</code></p>
</div>
</div></section>

<!-- -->

<section class="slide"><div>
    <img src="pictures/ios7/event-listener-all-no-timings-after.png" alt="">
    <p><a target="_blank" href="https://patrickhlauke.github.io/touch/tests/event-listener_all-no-timings.html">patrickhlauke.github.io/touch/tests/event-listener_all-no-timings.html</a></p>
    <p><small><a target="_blank" href="https://bugs.webkit.org/show_bug.cgi?id=128534"><span class="strike">Bug 128534 - 'mouseenter' mouse compat event not fired...</span></a></small></p>
</div></section>

<!-- -->

<section class="slide code"><div>
    <h2>events fired on tap</h2>
    <pre><code class="json">touchstart > [touchmove]+ > touchend >
(mouseenter) > mouseover > mousemove > mousedown >
(focus) > mouseup > click</code></pre>
    <p><small>(mouse events only fired for single-finger tap)</small></p>
</div></section>

<!-- -->

<section class="slide code"><div>
    <h2>on first tap</h2>
    <pre><code class="json">touchstart > [touchmove]+ > touchend >
(mouseenter) > mouseover > mousemove > mousedown >
(focus) > mouseup > click</code></pre>
    <h2>subsequent taps</h2>
    <pre><code class="json">touchstart > [touchmove]+ > touchend >
mousemove > mousedown > mouseup > click</code></pre>
    <h2>tapping away</h2>
    <pre><code class="json">mouseout > (mouseleave) > (blur)</code></pre>
</div></section>

<!-- -->

<section class="slide listing"><div>
    <ul>
    <li>too many <code>touchmove</code> events prevent mouse compatibility events after <code>touchend</code> (not considered a "clean" tap)</li>
    <li>too many <code>touchmove</code> events on activatable elements can lead to <code>touchcancel</code> (in old Chrome/Browser versions)</li>
    <li>not all browsers consistently send <code>touchmove</code></li>
    <li>differences in <code>focus</code> / <code>blur</code> and some mouse compatibility events (e.g. <code>mouseenter</code> / <code>mouseleave</code>)</li>
    <li>some events may only fire when tapping away to another focusable element (e.g. <code>blur</code>)
    </ul>
    <p>some browsers outright weird...</p>
</div></section>

<!-- -->

<section class="slide code"><div>
    <h2>Browser/Android 4.3</h2>
    <pre><code class="json"><mark>mouseover</mark> > <mark>mousemove</mark> > touchstart > touchend >
mousedown > mouseup > click</code></pre>
    <h2>Browser/Blackberry PlayBook 2.0</h2>
    <pre><code class="json">touchstart > <mark>mouseover</mark> > <mark>mousemove</mark> > <mark>mousedown</mark> >
touchend > mouseup > click</code></pre>
    <h2>UC Browser 10.8/Android 6</h2>
    <pre><code class="json"><mark>mouseover</mark> > <mark>mousemove</mark> > touchstart > (touchmove)+ > touchend >
mousedown > focus > mouseup > click</code></pre>
</div></section>

<!-- -->

<section class="slide"><div>
    <img src="pictures/sites/patrickhlauke-github-touch-results.png" alt="">
    <p><a target="_blank" href="https://patrickhlauke.github.io/touch/tests/results/">Touch/pointer events test results</a></p>
</div></section>

<!-- -->

<section class="slide statement"><div>
<div>
    <p><strong>shouldn't</strong> affect your code, unless you're expecting a very <strong>specific sequence</strong>...</p>
</div>
</div></section>

<!-- -->

<section class="slide impact"><div>
<div>
    <p><code>&lt;interlude &gt;</code></p>
    <p>simple <strong>feature detection</strong> for touch events</p>
</div>
</div></section>

<!-- -->

<section class="slide code"><div>
<pre><code class="js">/* feature detection for touch events */

if (<mark>'ontouchstart' in window</mark>) {
    /* some clever stuff here */
}

/* older browsers have flaky support so more
   hacky tests needed...use <mark>Modernizr.touch</mark> or similar */</code></pre>
</div></section>

<!-- -->

<section class="slide"><div>
    <img src="pictures/sites/touch-detect-chrome-mobile.png" alt="">
    <p><a target="_blank" href="https://patrickhlauke.github.io/touch/tests/touch-feature-detect.html">patrickhlauke.github.io/touch/tests/touch-feature-detect.html</a></p>
</div></section>

<!-- -->

<section class="slide code"><div>
<pre><code class="js">/* conditional "touch OR mouse/keyboard" event binding */

<mark>if ('ontouchstart' in window)</mark> {
  // set up event listeners for touch
  ...
} <mark>else</mark> {
  // set up event listeners for mouse/keyboard
  ...
}
</code></pre>
</div></section>

<!-- -->

<section class="slide cover impact"><div>
    <div><p>don't make it touch-exclusive</p></div>
    <img src="pictures/backgrounds/background-danger-415-volts.jpg" class="cover" alt="">
</div></section>

<!-- -->

<section class="slide impact"><div>
<div>
    <p>hybrid devices<br>touch <strong>+</strong> mouse <strong>+</strong> keyboard</p>
</div>
</div></section>

<!-- -->

<section class="slide singlepicture"><div>
<div>
    <img src="pictures/backgrounds/windows-2-in-1-touch-laptop.jpg" alt="Windows 2-in-1 touchscreen laptop/tablet devices">
</div>
</div></section>

<!-- -->

<section class="slide singlepicture"><div>
<div>
    <img src="pictures/backgrounds/window-touch-desktop.jpg" alt="All-in-one windows desktop device with touchscreen">
</div>
</div></section>

<!-- -->

<section class="slide"><div>
    <img src="pictures/sites/twitter-patrickhlauke-flickr-touch.png" alt="Tweet: a quick video showing the issue of naive 'if touch events then simply assume touch only' in flickr">
    <p><a target="_blank" href="https://twitter.com/patrick_h_lauke/status/717781821468098562">@patrick_h_lauke showing a naive "touch or mouse" issue on Flickr</a><br><small>(which has since been fixed)</small></p>
</div></section>

<!-- -->

<section class="slide"><div>
    <img src="pictures/sites/bugzilla-sites-with-touch.png" alt="Bugzilla">
    <p><a target="_blank" href="https://bugzilla.mozilla.org/show_bug.cgi?id=888304">Bug 888304 - touch-events on Firefox-desktop should be disabled until we can support them properly</a>
</div></section>

<!-- -->

<section class="slide"><div>
    <img src="pictures/sites/chromium-issue392584-enable-touchevent-api-all-the-time.png" alt="">
    <p><a target="_blank" href="https://bugs.chromium.org/p/chromium/issues/detail?id=392584">Issue 392584: TouchEvent API should be enabled consistently</a></p>
</div></section>

<!-- -->

<section class="slide"><div>
    <img src="pictures/sites/touch-detect-chrome-firefox-edge-desktop.png" alt="">
    <p>Chrome now returns <code>window.TouchEvent</code> on non-touch devices</p>
    <p><a target="_blank" href="https://patrickhlauke.github.io/touch/tests/touch-feature-detect.html">patrickhlauke.github.io/touch/tests/touch-feature-detect.html</a></p>
</div></section>

<!-- -->

<section class="slide impact"><div>
<div>
    <p>even on <strong>"mobile"</strong> we can have multiple inputs...</p>
</div>
</div></section>

<!-- -->

<section class="slide singlepicture"><div>
<div>
    <img src="pictures/htc-hero-android-2.1/photo-htc-hero-product-shot.jpg" alt="HTC Hero touchscreen phone with built-in trackball">
</div>
</div></section>

<!-- -->

<section class="slide singlepicture"><div>
<div>
    <img src="pictures/android/photo-android-laptops.jpg" alt="Android tablet-based laptops">
</div>
</div></section>

<!-- -->

<section class="slide"><div>
    <img src="pictures/backgrounds/photo-android-mouse.jpg" alt="">
    <p>Android + mouse – <strong>like touch</strong> (mouse emulating touch)</p>
    <p><code class="json">touchstart > touchend > mouseover > mousemove >
mousedown > (focus) > mouseup > click</code></p>
</div></section>

<!-- -->

<section class="slide"><div>
    <img src="pictures/backgrounds/photo-playbook-mouse.jpg" alt="">
    <p>Blackberry PlayBook 2.0 + mouse – <strong>like desktop</strong></p>
    <p><code class="json">mouseover > mousedown > (mousemove)+ > mouseup > click</code></p>
</div></section>

<!-- -->

<section class="slide"><div>
    <img src="pictures/backgrounds/photo-blackberry-leap-mouse.jpg" alt="">
    <p>Blackberry Leap (BBOS 10.1) + mouse – <strong>like desktop</strong></p>
    <p><code class="json">mouseover > mousedown > (mousemove)+ > mouseup > click</code></p>
</div></section>

<!-- -->

<section class="slide"><div>
    <img src="pictures/backgrounds/photo-win10mobile-mouse.jpg" alt="">
    <p>Windows 10 Mobile/Microsoft Edge + mouse – <strong>like desktop</strong></p>
    <p>mouse events (+ pointer events) + <code>click</code></p>
</div></section>

<!-- -->

<section class="slide"><div>
    <img src="pictures/backgrounds/photo-win10mobile-keyboard.jpg" alt="">
    <p>Windows 10 Mobile/Microsoft Edge + keyboard – <strong>like desktop</strong></p>
    <p><code class="json">focus > click</code></p>
</div></section>

<!-- -->

<section class="slide"><div>
    <img src="pictures/backgrounds/photo-android-keyboard.jpg" alt="">
    <p>Android + keyboard – <strong>like desktop</strong></p>
    <p><code class="json">focus > click</code></p>
</div></section>

<!-- -->

<section class="slide statement"><div>
<div>
    <p>iOS keyboard only works in same situations as on-screen keyboard<br>
    <small>(e.g. text inputs, URL entry)</small></p>
</div>
</div></section>

<!-- -->

<section class="slide"><div>
    <img src="pictures/ios7/ipad-voiceover.png" alt="">
    <p>VoiceOver enables full keyboard access on iOS</p>
</div></section>

<!-- -->

<section class="slide"><div>
    <img src="pictures/backgrounds/photo-ios-ipad-keyboard.jpg" alt="">
    <p>iOS + keyboard – <strong>similar to touch</strong></p>
    <p><code class="json">focus / touchstart > touchend > (mouseenter) > mouseover >
mousemove > mousedown > blur > mouseup > click</code></p>
</div></section>

<!-- -->

<section class="slide listing"><div>
    <h2>further scenarios?</h2>
    <ul>
    <li>desktop with external touchscreen</li>
    <li>touchscreen laptop with non-touch second screen</li>
    <li>touchscreen laptop with trackpad/mouse</li>
    <li>...and other permutations?</li>
    </ul>
</div></section>

<!-- -->

<section class="slide impact"><div>
<div>
    <p>no way to detect these cases...</p>
</div>
</div></section>

<!-- -->

<section class="slide"><div>
    <img src="pictures/sites/github-modernizr-detects-touch-events-not-touch-screens.png" alt="">
    <p><a target="_blank" href="https://github.com/modernizr/modernizr/issues/548"><code>Modernizr.touch</code> detects touch events not touch devices</a>
</div></section>

<!-- -->

<section class="slide"><div>
    <img src="pictures/sites/stucox-you-cant-detect-a-touchscreen.png" alt="">
    <p><a target="_blank" href="http://www.stucox.com/blog/you-cant-detect-a-touchscreen/">Stu Cox: You can't detect a touchscreen</a></p>
</div></section>

<!-- -->

<section class="slide"><div>
    <img src="pictures/sites/hacks-mozilla-detecting-touch-why-not-how.png" alt="">
    <p><a target="_blank" href="https://hacks.mozilla.org/2013/04/detecting-touch-its-the-why-not-the-how/">hacks.mozilla.org - Detecting touch [...]</a></p>
</div></section>

<!-- -->

<section class="slide code"><div>
<pre><code class="js">/* feature detection for touch events */

if ('ontouchstart' in window) {
<mark>    /* browser supports touch events but user is
       not necessarily using touch (exclusively) */</mark>

<mark>    /* it could be a mobile, tablet, desktop, fridge ... */</mark>
}
</code></pre>
</div></section>

<!-- -->

<section class="slide impact"><div>
<div>
    <p>touch <strong>or</strong> mouse <strong>or</strong> keyboard</p>
</div>
</div></section>

<!-- -->

<section class="slide impact"><div>
<div>
    <p>touch <strong>and</strong> mouse <strong>and</strong> keyboard</p>
</div>
</div></section>

<!-- -->

<section class="slide statement"><div>
<div>
    <p>what about<br><strong>CSS4 Media Queries</strong>?</p>
</div>
</div></section>

<!-- -->

<section class="slide"><div>
    <img src="pictures/sites/w3c-media-queries-level4.png" alt="">
    <p><a target="_blank" href="https://drafts.csswg.org/mediaqueries-4/">W3C Media Queries Level 4 (Editor's Draft)</a></p>
</div></section>

<!-- -->

<section class="slide code"><div>
    <pre><code class="css">/* MQ4 Interaction Media Features*/

pointer: none | coarse | fine
hover: none | hover

any-pointer: none | coarse | fine
any-hover: none | hover
</code></pre>
<p><small><a target="_blank" href="https://lists.w3.org/Archives/Public/www-style/2016Feb/0041.html"><code>hover: on-demand</code> / <code>any-hover: on-demand</code> removed in recent drafts</a></small></p>
</div></section>

<!-- -->

<section class="slide"><div>
    <img src="pictures/sites/dev-opera-media-features.png" alt="">
    <p><a target="_blank" href="https://dev.opera.com/articles/media-features/">dev.opera - Interaction Media Features and their potential (for incorrect assumptions)</a></p>
</div></section>

<!-- -->

<section class="slide"><div>
    <img src="pictures/sites/css4-interaction-media-features-phone-mouse.png" alt="CSS4 Interaction Media Features tests on a touchscreen phone, with and without a paired bluetooth mouse - primary input remains touchscreen (so pointer:coarse and hover:on-demand), but additional capabilities of mouse are detected (any-pointer:fine and hover:hover also evaluated to true)">
    <p><a target="_blank" href="http://patrickhlauke.github.io/touch/pointer-hover-any-pointer-any-hover/">patrickhlauke.github.io/touch/pointer-hover-any-pointer-any-hover</a></p>
    <p><small>primary input is unchanged (and Chrome/Android required a full restart)</small></p>
</div></section>

<!-- -->

<section class="slide code"><div>
    <pre><code class="css">/* Naive uses of Interaction Media Features */

@media (pointer: fine) {
    /* primary input has fine pointer precision...
       so make all buttons/controls small? */
}

@media (hover: hover) {
    /* primary input has hover...so we can rely on it? */
}

/* pointer and hover only check "primary" input, but
   what if there's a secondary input that lacks capabilities? */</code></pre>
</div></section>

<!-- -->

<section class="slide code"><div>
    <pre><code class="css">/* Better uses of Interaction Media Features */

@media (any-pointer: coarse) {
    /* at least one input has coarse pointer precision...
       provide larger buttons/controls for touch  */
}

/* test for *any* "least capable" inputs (primary or not) */

<del>@media (any-hover: none) {</del>
    <del>/* at least one input lacks hover capability...</del>
       <del>don't rely on it or avoid altogether */</del>
<del>}</del>
</code></pre>
<p><small>Limitation: <a target="_blank" href="https://github.com/w3c/csswg-drafts/issues/841">[mediaqueries-4] any-hover can't be used to detect mixed hover and non-hover capable pointers</a>. Also, <code>pointer</code>/<code>hover</code>/<code>any-pointer</code>/<code>any-hover</code> don't cover non-pointer inputs (e.g. keyboards) – <strong>always assume non-hover-capable inputs</strong></small></p>
</div></section>

<!-- -->

<section class="slide statement"><div>
<div>
    <p>detect which input the users is using <strong>right now</strong>...</p>
</div>
</div></section>

<!-- -->

<section class="slide"><div>
    <img src="pictures/sites/github-what-input.png" alt="">
    <p><a target="_blank" href="https://github.com/ten1seven/what-input">GitHub: ten1seven / what-input</a></p>
</div></section>

<!-- -->

<section class="slide"><div>
    <img src="pictures/sites/what-input-demo.png" alt="">
    <p><a target="_blank" href="http://ten1seven.github.io/what-input/">Demo: What Input?</a></p>
</div></section>

<!-- -->

<section class="slide singlepicture"><div>
    <div>
    <img src="pictures/win10/office-2013-mouse-touch-switch.png" alt="Office 2013 in Windows offers a 'Touch/Mouse mode' switch - shown by default on touch-capable devices, but can be accessed even on mouse-only devices; switching to touch mode increases spacing and touch target of all ribbon controls">
    <p>if in doubt, offer a way to switch interfaces...<br>or just <strong>always use a touch-optimised interface</strong></p>
    </div>
</div></section>

<!-- -->

<section class="slide statement"><div>
<div>
    <p><code>&lt;/ interlude &gt;</code></p>
</div>
</div></section>

<!-- -->

<section class="slide impact"><div>
<div>
    <p>touch events<br><strong>vs</strong><br><strong>limitations</strong>/<strong>problems</strong></p>
</div>
</div></section>

<!-- -->

<section class="slide statement listing"><div>
<div>
    <ol>
        <li>delayed event dispatch</li>
        <li>mousemove doesn't track</li>
    </ol>
</div>
</div></section>

<!-- -->

<section class="slide statement listing"><div>
<div>
    <ol>
        <li><strong>delayed event dispatch</strong></li>
        <li>mousemove doesn't track</li>
    </ol>
</div>
</div></section>

<!-- -->

<section class="slide"><div>
    <img src="pictures/ios7/event-listener-show-delay-after.png" alt="">
    <p><a target="_blank" href="https://patrickhlauke.github.io/touch/tests/event-listener_show-delay.html">patrickhlauke.github.io/touch/tests/event-listener_show-delay.html</a></p>
    <p><small>less of a problem in modern browsers, but for <strong>iOS < 9.3 or older Androids</strong> still relevant</small></p>
</div></section>

<!-- -->

<section class="slide impact"><div>
<div>
    <p>why the delay?<br><strong>double-tap to zoom</strong><br><small>(mostly anyway)</small></p>
</div>
</div></section>

<!-- -->

<section class="slide impact"><div>
<div>
    <p><strong>when</strong> does the delay happen?</p>
</div>
</div></section>

<!-- -->

<section class="slide"><div>
    <img src="pictures/ios7/event-listener-all-after.png" alt="">
    <p><a target="_blank" href="https://patrickhlauke.github.io/touch/tests/event-listener.html">patrickhlauke.github.io/touch/tests/event-listener.html</a></p>
</div></section>

<!-- -->

<section class="slide code"><div>
    <h2>touch / mouse events delay</h2>
    <pre><code class="json">touchstart > [touchmove]+ > touchend >

<mark>[300ms delay]</mark>

(mouseenter) > mouseover > mousemove > mousedown >
(focus) > mouseup > click</code></pre>
</div></section>

<!-- -->

<section class="slide impact"><div>
<div>
    <p>“how can we make it feel <strong>responsive</strong> like a native app?”</p>
</div>
</div></section>

<!-- -->

<section class="slide impact"><div>
<div>
    <p>react to events fired <strong>before</strong> the 300ms delay...</p>
</div>
</div></section>

<!-- -->

<section class="slide statement"><div>
<div>
    <p><code>touchstart</code> for an “immediate” control<br><small>(e.g. fire/jump button on a game)</small></p>
</div>
</div></section>

<!-- -->

<section class="slide statement"><div>
<div>
    <p><code>touchend</code> for a control that fires after finger lifted</p>
    <p><small>(but this can result in events firing after zoom/scroll)</small></p>
</div>
</div></section>

<!-- -->

<section class="slide cover impact"><div>
    <div><p>don't make it touch-exclusive</p></div>
    <img src="pictures/backgrounds/background-danger-415-volts.jpg" class="cover" alt="">
</div></section>

<!-- -->

<section class="slide code"><div>
<pre><code class="js">/* DON'T DO THIS:
  conditional "touch OR mouse/keyboard" event binding */

<mark>if ('ontouchstart' in window)</mark> {
  // set up event listeners for touch
  foo.addEventListener('touchend', ...);
  ...
} <mark>else</mark> {
  // set up event listeners for mouse/keyboard
  foo.addEventListener('click', ...);
  ...
}
</code></pre>
</div></section>

<!-- -->

<section class="slide"><div>
    <img src="pictures/win10/chrome-naive-touch-or-mouse-touchscreen-desktop.png" alt="">
    <p><a target="_blank" href="https://patrickhlauke.github.io/touch/tests/event-listener_naive-touch-or-mouse.html">patrickhlauke.github.io/touch/tests/event-listener_naive-touch-or-mouse.html</a></p>
</div></section>

<!-- -->

<section class="slide code"><div>
<pre><code class="js">/* DO THIS:
   doubled-up "touch AND mouse/keyboard" event binding */

// set up event listeners for touch
foo.addEventListener('touchend', ...);

// set up event listeners for mouse/keyboard
foo.addEventListener('click', ...);

/* <mark>but this would fire our function twice for touch?</mark> */
</code></pre>
<p><a target="_blank" href="https://patrickhlauke.github.io/touch/tests/event-listener_naive-event-doubling.html">patrickhlauke.github.io/touch/tests/event-listener_naive-event-doubling.html</a></p>
</div></section>

<!-- -->

<section class="slide code"><div>
<pre><code class="js">/* DO THIS:
   doubled-up "touch AND mouse/keyboard" event binding */

// set up event listeners for touch
foo.addEventListener('touchend', function(e) {
  <mark>// prevent compatibility mouse events and click</mark>
  <mark>e.preventDefault();</mark>
  ...
});

// set up event listeners for mouse/keyboard
foo.addEventListener('click', ...);
</code></pre>
<p><a target="_blank" href="https://patrickhlauke.github.io/touch/tests/event-listener_naive-event-doubling-fixed.html">patrickhlauke.github.io/touch/tests/event-listener_naive-event-doubling-fixed.html</a></p>
</div></section>

<!-- -->

<section class="slide cover impact"><div>
    <div><p><code>preventDefault()</code> kills<br>scrolling, pinch/zoom, etc<p></div>
    <img src="pictures/backgrounds/background-danger-415-volts.jpg" class="cover" alt="">
</div></section>

<!-- -->

<section class="slide impact"><div>
<div>
    <p>apply <code>preventDefault()</code> carefully<br><small>(just on buttons/links, not entire page)</small></p>
</div>
</div></section>

<!-- -->

<section class="slide"><div>
    <img src="pictures/sites/github-fastclick.png" alt="">
    <p><a target="_blank" href="https://github.com/ftlabs/fastclick">github.com/ftlabs/fastclick</a></p>
</div></section>

<!-- -->

<section class="slide"><div>
    <img src="pictures/ios8/bootstrap-vanilla.png" alt="Bootstrap slide-down navigation button has 300ms delay in iOS by default">
    <p><a target="_blank" href="https://patrickhlauke.github.io/touch/fastclick/">patrickhlauke.github.io/touch/fastclick</a></p>
    <p><a target="_blank" href="https://www.youtube.com/watch?v=5VCQjBi8m4U">YouTube: iOS/Safari 300ms click delay: vanilla Bootstrap and using fastclick.js</a></p>
</div></section>

<!-- -->

<section class="slide"><div>
    <img src="pictures/ios8/bootstrap-fastclick.png" alt="Bootstrap with simple FastClick.js addition - slide-down navigation button has no more delay">
    <p><a target="_blank" href="https://patrickhlauke.github.io/touch/fastclick/fastclick.html">patrickhlauke.github.io/touch/fastclick/fastclick.html</a></p>
    <p><a target="_blank" href="https://www.youtube.com/watch?v=5VCQjBi8m4U">YouTube: iOS/Safari 300ms click delay: vanilla Bootstrap and using fastclick.js</a></p>
</div></section>

<!-- -->

<section class="slide impact"><div>
<div>
    <p>browsers working to remove <strong>double-tap to zoom</strong> delay</small></p>
</div>
</div></section>

<!-- -->

<section class="slide statement"><div>
<div>
    <p><strong>non-scalable/zoomable</strong> viewport and<br> <strong>"double-tap to zoom"</strong></p>
</div>
</div></section>

<!-- -->

<section class="slide"><div>
    <img src="pictures/android/chrome-user-scalable-no-after.png" alt="">
    <p><code class="html">&lt;meta name="viewport" content="user-scalable=no"></code></p>
    <p><a target="_blank" href="https://patrickhlauke.github.io/touch/tests/event-listener_user-scalable-no.html">patrickhlauke.github.io/touch/tests/event-listener_user-scalable-no.html</a></p>
</div></section>

<!-- -->

<section class="slide"><div>
    <img src="pictures/sites/trac-webkit-remove300ms-viewport-unscalable.png" alt="">
    <p><a target="_blank" href="https://trac.webkit.org/changeset/191072">Changeset 191072 - Web pages with unscalable viewports shouldn't have a single tap delay</a></p>
    <p><small>(from iOS 9.3 onwards)</small></p>
</div></section>

<!-- -->

<section class="slide impact"><div>
<div>
<p>what about <strong>accessibility</strong>?</p>
</div>
</div></section>

<!-- -->

<section class="slide"><div>
    <img src="pictures/android/chrome-force-enable-zoom-settings.png" alt="Chrome's 'Force enable zoom' setting">
    <p><small>Chrome: Settings > Accessibility > Force enable zoom</small></p>
</div></section>

<!-- -->

<section class="slide"><div>
    <img src="pictures/android/opera4.3-force-enable-zoom-settings.png" alt="Opera/Android's 'Force enable zoom' setting">
    <p><small>Opera: Settings > Force enable zoom</small></p>
</div></section>

<!-- -->

<section class="slide"><div>
    <img src="pictures/android/firefox-android-force-zoom.png" alt="Firefox/Android's 'Always enable zoom' setting">
    <p><small>Firefox: Settings > Accessibility > Always enable zoom</small></p>
</div></section>

<!-- -->

<section class="slide"><div>
    <img src="pictures/android/samsung-internet-settings-manual-zoom.png" alt="Samsung Internet's 'Manual Zoom' setting">
    <p><small>Samsung Internet: Internet settings > Manual zoom</small></p>
</div></section>

<!-- -->

<section class="slide"><div>
    <img src="pictures/android/chrome-force-enable-zoom-delay.png" alt="When 'Force enable zoom' is turned on, users can still zoom, but the 300ms delay - even with user-scalable=no - returns. A fair compromise?">
    <p>"Force enable zoom" reintroduces delay – a fair compromise?</p>
    <p><a target="_blank" href="https://patrickhlauke.github.io/touch/tests/event-listener_user-scalable-no.html">patrickhlauke.github.io/touch/tests/event-listener_user-scalable-no.html</a></p>
</div></section>

<!-- -->

<section class="slide"><div>
    <img src="pictures/sites/twitter-thomas-fuchs-ios10beta-zoom.png" alt="Thomas Fuchs' tweet, including a screengrab from Safari/iOS10beta3 changelog: To improve accessibility on websites in Safari, users can now pinch-to-zoom">
    <p><a target="_blank" href="https://twitter.com/thomasfuchs/status/742531231007559680/photo/1">@thomasfuchs - Safari/iOS10beta3 ignores unscalable viewports</a></p>
    <p><small>(no official Apple documentation about the change...but the 300ms delay is back)</small></p>
</div></section>

<!-- -->

<section class="slide"><div>
    <img src="pictures/sites/developer-microsoft-edge-changelog-mobile-zoom.png" alt="New web platform features announcement: On Windows 10 Mobile devices, the user can now zoom into the page regardless of zoom settings defined by meta viewport">
    <p><a target="_blank" href="https://developer.microsoft.com/en-us/microsoft-edge/platform/changelog/desktop/15007/">Windows 10 build 15007 on Mobile ignores unscalable viewports</a></p>
</div></section>

<!-- -->

<section class="slide statement"><div>
<div>
    <p><strong>"mobile optimised"</strong> viewport and<br> <strong>"double-tap to zoom"</strong></p>
</div>
</div></section>

<!-- -->

<section class="slide"><div>
    <img src="pictures/sites/developers-google-300ms-tap-delay-gone-away.png" alt="">
    <p>Chrome 32+ / Android: <code>content="width=device-width"</code><br>suppresses double-tap-to-zoom, still allows pinch zoom</p>
    <p><a target="_blank" href="https://developers.google.com/web/updates/2013/12/300ms-tap-delay-gone-away">Google Developers: 300ms tap delay, gone away</a></p>
</div></section>

<!-- -->

<section class="slide"><div>
    <img src="pictures/sites/bugzilla-remove-300ms-for-width-device-width.png" alt="">
    <p><a target="_blank" href="https://bugzilla.mozilla.org/show_bug.cgi?id=941995">Bug 941995 - Remove 300ms [...] on "responsive" pages</a></p>
    <p><strong>[RESOLVED FIXED]</strong></p>
</div></section>

<!-- -->

<section class="slide"><div>
    <img src="pictures/sites/webkit-blog-more-responsive-tapping-on-ios.png" alt="">
    <p><a target="_blank" href="https://webkit.org/blog/5610/more-responsive-tapping-on-ios/">WebKit blog: More Responsive Tapping on iOS</a></p>
</div></section>

<!-- -->

<section class="slide"><div>
    <img src="pictures/sites/patrickhlauke-github-touch-results-300ms-delay.png" alt="">
    <p><a target="_blank" href="https://patrickhlauke.github.io/touch/tests/results/#suppressing-300ms-delay">patrickhlauke.github.io/touch/tests/results/#suppressing-300ms-delay</a></p>
</div></section>

<!-- -->

<section class="slide listing"><div>
    <h2>suppressing 300ms delay</h2>
    <p>if your code does rely on handling <code>click</code> / mouse events:</p>
    <ul>
    <li>"mobile optimised" <code>&lt;meta name="viewport" content="width=device-width"&gt;</code></li>
    <li>add <code>touch-action:manipulation</code> in CSS (part of Pointer Events)</li>
    <li>use helper library like <a target="_blank" href="https://github.com/ftlabs/fastclick">fastclick.js</a> for older browsers</li>
    <li><del>make your viewport non-scalable...</del></li>
    </ul>
</div></section>

<!-- -->

<section class="slide statement listing"><div>
<div>
    <ol>
        <li>delayed event dispatch</li>
        <li><strong>mousemove doesn't track</strong></li>
    </ol>
</div>
</div></section>

<!-- -->

<section class="slide"><div>
    <img src="pictures/win8/chrome-particle-party.png" alt="">
    <p><a target="_blank" href="https://patrickhlauke.github.io/touch/particle/2">patrickhlauke.github.io/touch/particle/2</a></p>
</div></section>

<!-- -->

<section class="slide"><div>
    <img src="pictures/android/chrome-particle-party-mouse-only.png" alt="">
    <p><a target="_blank" href="https://patrickhlauke.github.io/touch/particle/2">patrickhlauke.github.io/touch/particle/2</a></p>
</div></section>

<!-- -->

<section class="slide code"><div>
    <h2>events fired on tap</h2>
    <pre><code class="json">touchstart > [touchmove]+ > touchend >
(mouseenter) > mouseover >
<mark>mousemove*</mark> > mousedown > (focus) >
mouseup > click</code></pre>
    <p><small>* mouse event emulation fires only a single <code>mousemove</code></small><p>
    <p><small>too many <code>touchmove</code> events prevent mouse compatibility events after <code>touchend</code></small></p>
</div></section>

<!-- -->

<section class="slide impact"><div>
<div>
    <p>doubling up handling of <code>mousemove</code> and <code>touchmove</code></p>
</div>
</div></section>

<!-- -->

<section class="slide code"><div>
<pre><code class="js">var posX, posY;

function positionHandler(e) {
    posX = <mark>e.clientX</mark>;
    posY = <mark>e.clientY</mark>;
}

canvas.addEventListener('<mark>mousemove</mark>', positionHandler, false);</code></pre>
</div></section>

<!-- -->

<section class="slide code"><div>
<pre><code class="js">var posX, posY;

function positionHandler(e) {
    posX = <mark>e.clientX</mark>;
    posY = <mark>e.clientY</mark>;
}

canvas.addEventListener('<mark>mousemove</mark>', positionHandler, false);
canvas.addEventListener('<mark>touchmove</mark>', positionHandler, false);

/* <mark>but this won't work for touch...</mark> */
</code></pre>
</div></section>

<!-- -->

<section class="slide code"><div>
<pre><code class="js">interface MouseEvent : UIEvent {
    readonly attribute long <mark>screenX</mark>;
    readonly attribute long <mark>screenY</mark>;
    readonly attribute long <mark>clientX</mark>;
    readonly attribute long <mark>clientY</mark>;
    readonly attribute boolean ctrlKey;
    readonly attribute boolean shiftKey;
    readonly attribute boolean altKey;
    readonly attribute boolean metaKey;
    readonly attribute unsigned short button;
    readonly attribute EventTarget relatedTarget;
    // [DOM4] UI Events
    readonly attribute unsigned short buttons;
};</code></pre>
<p><a target="_blank" href="http://www.w3.org/TR/DOM-Level-2-Events/events.html#Events-MouseEvent">www.w3.org/TR/DOM-Level-2-Events/events.html#Events-MouseEvent</a></p><p><a target="_blank" href="https://www.w3.org/TR/uievents/#events-mouseevents">www.w3.org/TR/uievents/#events-mouseevents</p>
</div></section>

<!-- -->

<section class="slide code"><div>
<pre><code class="js">partial interface MouseEvent {
    readonly attribute double screenX;
    readonly attribute double screenY;
    readonly attribute double <mark>pageX</mark>;
    readonly attribute double <mark>pageY</mark>;
    readonly attribute double clientX;
    readonly attribute double clientY;
    readonly attribute double <mark>x</mark>;
    readonly attribute double <mark>y</mark>;
    readonly attribute double <mark>offsetX</mark>;
    readonly attribute double <mark>offsetY</mark>;
};</code></pre>
<p><a target="_blank" href="http://www.w3.org/TR/cssom-view/#extensions-to-the-mouseevent-interface">www.w3.org/TR/cssom-view/#extensions-to-the-mouseevent-interface</a></p>
</div></section>

<!-- -->

<!-- after 14 years, Mozilla Firefox now also supports offsetX/offsetY - https://bugzilla.mozilla.org/show_bug.cgi?id=69787 / https://hacks.mozilla.org/2015/08/trainspotting-firefox-40/ -->

<!-- -->

<section class="slide code"><div>
<pre><code class="js">interface TouchEvent : UIEvent {
    readonly attribute <mark>TouchList touches</mark>;
    readonly attribute <mark>TouchList targetTouches</mark>;
    readonly attribute <mark>TouchList changedTouches</mark>;
    readonly attribute boolean altKey;
    readonly attribute boolean metaKey;
    readonly attribute boolean ctrlKey;
    readonly attribute boolean shiftKey;
};</code></pre>
<p><a target="_blank" href="http://www.w3.org/TR/touch-events/#touchevent-interface">www.w3.org/TR/touch-events/#touchevent-interface</a></p>
</div></section>

<!-- -->

<section class="slide code"><div>
<pre><code class="js">interface Touch {
    readonly attribute long identifier;
    readonly attribute EventTarget target;
    readonly attribute long <mark>screenX</mark>;
    readonly attribute long <mark>screenY</mark>;
    readonly attribute long <mark>clientX</mark>;
    readonly attribute long <mark>clientY</mark>;
    readonly attribute long <mark>pageX</mark>;
    readonly attribute long <mark>pageY</mark>;
};</code></pre>
<p><a target="_blank" href="http://www.w3.org/TR/touch-events/#touch-interface">www.w3.org/TR/touch-events/#touch-interface</a></p>
</div></section>

<!-- -->

<section class="slide listing"><div>
    <h2><code>TouchList</code> differences</h2>
    <dl>
    <dt><code>touches</code></dt>
    <dd>all touch points on screen</dd>
    <dt><code>targetTouches</code></dt>
    <dd>all touch points that <em>started</em> on the element</dd>
    <dt><code>changedTouches</code></dt>
    <dd>touch points that caused the event to fire</dd>
    </dl>
</div></section>

<!-- -->

<section class="slide"><div>
    <img src="pictures/ios7/touchlist-objects.png" alt="">
    <p><a target="_blank" href="https://patrickhlauke.github.io/touch/touchlist-objects">patrickhlauke.github.io/touch/touchlist-objects</a></p>
</div></section>

<!-- -->

<section class="slide code"><div>
<pre><code class="js">var posX, posY;

function positionHandler(e) {
    <mark>if ((e.clientX)&amp;&amp;(e.clientY))</mark> {
        posX = e.clientX; posY = e.clientY;
    } <mark>else if (e.targetTouches)</mark> {
        posX = e.targetTouches[0].clientX;
        posY = e.targetTouches[0].clientY;
        <mark>e.preventDefault()</mark>;
    }
}

canvas.addEventListener('mousemove', positionHandler, false );
canvas.addEventListener('touchmove', positionHandler, false );</code></pre>
</div></section>

<!-- -->

<section class="slide"><div>
    <img src="pictures/android/chrome-particle-party-mouse-and-touch.png" alt="Particle party with touch working correctly with moving finger on Android device">
    <p><a target="_blank" href="https://patrickhlauke.github.io/touch/particle/3">patrickhlauke.github.io/touch/particle/3</a></p>
</div></section>

<!-- -->

<section class="slide"><div>
    <img src="pictures/sites/paranoid.png" alt="">
    <p><a target="_blank" href="https://patrickhlauke.github.io/touch/paranoid_0.5/">patrickhlauke.github.io/touch/paranoid_0.5</a></p>
    <p><a target="_blank" href="http://www.splintered.co.uk/experiments/archives/paranoid_0.5">www.splintered.co.uk/experiments/archives/paranoid_0.5</a></p>
</div></section>

<!-- -->

<section class="slide"><div>
    <img src="pictures/android/chrome-ratchet-swipe-carousel.png" alt="">
    <p><a target="_blank" href="https://patrickhlauke.github.io/touch/picture-slider">patrickhlauke.github.io/touch/picture-slider</a></p>
</div></section>

<!-- -->

<section class="slide impact"><div>
<div>
    <p>tracking finger movement over time ... <strong>swipe gestures</strong></p>
</div>
</div></section>

<!-- -->

<section class="slide"><div>
    <img src="pictures/ios7/swipe-after.png" alt="">
    <p><a target="_blank" href="https://patrickhlauke.github.io/touch/swipe">patrickhlauke.github.io/touch/swipe</a></p>
</div></section>

<!-- -->

<section class="slide code"><div>
<pre><code class="js">/* Swipe detection from basic principles */

Δt = end.time - start.time;
Δx = end.x - start.x;
Δy = end.y - start.y;

if ((<mark>Δt > timeThreshold</mark>) || (<mark>(Δx + Δy) < distanceThreshold</mark>)) {
  /* too slow or movement too small */
} else {
  /* it's a swipe!
     - use Δx and Δy to determine direction
     - pythagoras √( Δx² + Δy² ) for distance
     - distance/Δt to determine speed */
}</code></pre>
</div></section>

<!-- -->

<section class="slide impact"><div>
<div>
    <p>don't forget <strong>mouse</strong>/<strong>keyboard</strong>!</p>
</div>
</div></section>

<!-- -->

<section class="slide cover impact"><div>
    <div><p><code>touchmove</code> fires...a lot!</p></div>
    <img src="pictures/backgrounds/background-danger-415-volts.jpg" class="cover" alt="">
</div></section>

<!-- -->

<section class="slide impact"><div>
<div>
    <p>do absolute <strong>minimum</strong> on each <code>touchmove</code><br>
    <small>(usually: store coordinates)</small></p>
</div>
</div></section>

<!-- -->

<section class="slide impact"><div>
<div>
    <p>do heavy lifting (drawing etc.) <strong>separately</strong>, avoid queueing<br>
    <small>(e.g. using <code>setTimeout</code> and/or <code>requestAnimationFrame</code>)</small></p>
</div>
</div></section>

<!-- -->

<section class="slide statement"><div>
<div>
    <p><strong>debounce</strong> / <strong>throttle</strong> events</p>
</div>
</div></section>

<!-- -->

<section class="slide"><div>
    <img src="pictures/sites/github-limitjs.png" alt="">
    <p><a target="_blank" href="https://github.com/m-gagne/limit.js">GitHub: m-gagne / limit.js</a></p>
</div></section>

<!-- -->

<section class="slide"><div>
    <img src="pictures/ios9/safari-limitjs.png" alt="">
    <p><a target="_blank" href="https://patrickhlauke.github.io/touch/touch-limit">patrickhlauke.github.io/touch/touch-limit</a></p>
</div></section>

<!-- -->

<section class="slide impact"><div>
<div>
    <p>why stop at a single point?<br><strong>multitouch</strong> support</p>
</div>
</div></section>

<!-- -->

<section class="slide code"><div>
<pre><code class="js">interface TouchEvent : UIEvent {
    readonly attribute <mark>TouchList touches</mark>;
    readonly attribute <mark>TouchList targetTouches</mark>;
    readonly attribute <mark>TouchList changedTouches</mark>;
    readonly attribute boolean altKey;
    readonly attribute boolean metaKey;
    readonly attribute boolean ctrlKey;
    readonly attribute boolean shiftKey;
};</code></pre>
<p><a target="_blank" href="http://www.w3.org/TR/touch-events/#touchevent-interface">www.w3.org/TR/touch-events/#touchevent-interface</a></p>
</div></section>

<!-- -->

<section class="slide code"><div>
<pre><code class="js">/* iterate over relevant TouchList */

for (i=0; i&lt;<mark>e.targetTouches</mark>.length; i++) {
    ...
    posX = <mark>e.targetTouches[i].clientX</mark>;
    posY = <mark>e.targetTouches[i].clientY</mark>;
    ...
}</code></pre>
</div></section>

<!-- -->

<section class="slide"><div>
    <img src="pictures/android/chrome-multitracker.png" alt="">
    <p><a target="_blank" href="https://patrickhlauke.github.io/touch/tracker/multi-touch-tracker.html">patrickhlauke.github.io/touch/tracker/multi-touch-tracker.html</a></p>
</div></section>

<!-- -->

<section class="slide cover impact"><div>
<div>
    <p>iOS/iPad <code>preventDefault()</code> can't override 4-finger gestures</p>
</div>
    <img src="pictures/backgrounds/photo-ios-ipad-4-finger-gesture.jpg" class="cover" alt="">
</div></section>

<!-- -->

<section class="slide cover impact"><div>
<div>
    <p>iOS7+ Safari/WebView <code>preventDefault()</code> can't override edge swipes</p>
</div>
    <img src="pictures/backgrounds/photos-ios-iphone-safari-history-swipe-gestures.jpg" class="cover" alt="Multitouch tracker in iOS/Safari - starting a finger movement on the edge of the screen starts a back/forward gesture that can't be overridden">
</div></section>

<!-- -->

<section class="slide impact"><div>
<div>
    <p>multitouch gestures</p>
</div>
</div></section>

<!-- -->

<section class="slide code"><div>
<pre><code class="js">/* <mark>iOS/Safari/WebView</mark> has gesture events for size/rotation,
<mark>not part</mark> of the W3C Touch Events spec. */

/* gesturestart / gesturechange / gestureend */

foo.addEventListener('gesturechange', function(e) {
    /* e.<strong>scale</strong>
       e.<strong>rotation</strong> */

    /* values can be plugged directly into
       CSS transforms etc */
});

/* <mark>not supported in Chrome/Firefox/Opera</mark> */
</code></pre>
<p><a target="_blank" href="https://developer.apple.com/library/content/documentation/AppleApplications/Reference/SafariWebContent/HandlingEvents/HandlingEvents.html#//apple_ref/doc/uid/TP40006511-SW23">iOS Developer Library - Safari Web Content Guide - Handling gesture events</a></p>
</div></section>

<!-- -->

<section class="slide code"><div>
<pre><code class="js">/* Pinch/rotation detection from basic principles */

Δx = x2 - x1;
Δy = y2 - y1;


/* pythagoras √( Δx² + Δy² ) to calculate distance */

Δd = Math.sqrt( (Δx * Δx) + (Δy * Δy) );


/* trigonometry to calculate angle */

α = Math.atan2( Δy, Δx );

</code></pre>
<p><a target="_blank" href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Math/atan2">Mozilla Developer Network: <code>Math.atan2()</code></a></p>
</div></section>

<!-- -->

<section class="slide"><div>
    <img src="pictures/ios7/ipad-picture-organiser.png" alt="Picture Organiser demo on iOS7/iPad, with four images freely moved/scaled/rotated">
    <p><a target="_blank" href="https://patrickhlauke.github.io/touch/picture-organiser">patrickhlauke.github.io/touch/picture-organiser</a></p>
</div></section>

<!-- -->

<section class="slide impact"><div>
<div>
    <p>Touch Events specification<br><strong>grey areas</strong>...</p>
</div>
</div></section>

<!-- -->

<section class="slide statement"><div>
<div>
    <p>do touch events fire during <strong>scroll</strong>/<strong>zoom</strong>?</p>
</div>
</div></section>

<!-- -->

<section class="slide"><div>
    <img src="pictures/ios8/safari-touch-events-scrolling-zooming.png" alt="">
    <p>not defined in spec (yet), but <em>de facto</em><br><strong>yes</strong> in <strong>most modern browsers</strong></p>
    <p><a target="_blank" href="https://patrickhlauke.github.io/touch/gesture-touch/">patrickhlauke.github.io/touch/gesture-touch</a></p>
</div></section>

<!-- -->

<section class="slide impact"><div>
<div>
    <p>Touch Events extensions...</p>
</div>
</div></section>

<!-- -->

<section class="slide"><div>
    <img src="pictures/sites/w3c-touch-events-extensions.png" alt="">
    <p><a target="_blank" href="https://dvcs.w3.org/hg/webevents/raw-file/default/touchevents.html">W3C Touch Events Extensions WG Note</a></p>
</div></section>

<!-- -->

<section class="slide code"><div>
<pre><code class="js">/* Extension to touch objects */

partial interface Touch {
  readonly  attribute float radiusX;
  readonly  attribute float radiusY;
  readonly  attribute float rotationAngle;
  readonly  attribute float force;
};</code></pre>
</div></section>

<!-- -->

<section class="slide code"><div>
<pre><code class="js">/* Touch Events – contact geometry */

partial interface Touch {
  readonly  attribute float <mark>radiusX</mark>;
  readonly  attribute float <mark>radiusY</mark>;
  readonly  attribute float <mark>rotationAngle</mark>;
  readonly  attribute float force;
};</code></pre>
</div></section>

<!-- -->

<section class="slide"><div>
    <img src="pictures/android/nexus10-touch-events-radiusx-radiusy-rotationangle-firefox.png" alt="">
    <p><a target="_blank" href="http://patrickhlauke.github.io/touch/tracker/tracker-radius-rotationangle.html">patrickhlauke.github.io/touch/tracker/tracker-radius-rotationangle.html</a></p>
    <p><a target="_blank" href="https://www.youtube.com/watch?v=fnSp8VFf-b8">YouTube: Touch Events: radiusX, radiusY and rotationAngle</a></p>
</div></section>

<!-- -->

<section class="slide code"><div>
<pre><code class="js">/* Touch Events – force */

partial interface Touch {
  readonly  attribute float radiusX;
  readonly  attribute float radiusY;
  readonly  attribute float rotationAngle;
  readonly  attribute float <mark>force</mark>;
};</code></pre>
 <p><code>force</code>: value in range <code>0</code> – <code>1</code>. if no hardware support <code>0</code><br><small>(some devices, e.g. Nexus 10, "fake" <code>force</code> based on <code>radiusX</code> / <code>radiusY</code>)</small></p>
</div></section>

<!-- -->

<section class="slide"><div>
    <img src="pictures/ios9/iphone6s-touch-events-force.png" alt="">
    <p><a target="_blank" href="http://patrickhlauke.github.io/touch/tracker/tracker-force-pressure.html">patrickhlauke.github.io/touch/tracker/tracker-force-pressure.html</a></p>
    <p>iPhone 6s with 3D Touch supports <code>force</code>...</p>
    <p><small>(<strong>Safari and WKWebView</strong>, e.g. Chrome/iOS, but <strong>not UIWebView</strong>, e.g. Firefox/iOS)</small></p>
</div></section>

<!-- -->

<section class="slide"><div>
    <img src="pictures/sites/w3c-touch-events-level2-editors-draft.png" alt="">
    <p><a target="_blank" href="http://w3c.github.io/touch-events/">W3C Touch Events Level 2 (Editor's Draft)</a></p>
    <p>(merges errata, touch events extensions, fractional touch coordinates)</p>
</div></section>

<!-- //////////////// POINTER EVENTS //////////////// -->

<section class="slide impact" id="pointerevents"><div>
<div>
    <h2>Pointer Events</h2>
</div>
</div></section>

<!-- -->

<section class="slide statement"><div>
<div>
    <p>up to <strong>IE9</strong> (Win7 / WinPhone7.5) only mouse events</p>
</div>
</div></section>

<!-- -->

<section class="slide statement"><div>
<div>
    <p>in <strong>IE10</strong> Microsoft introduced <strong>Pointer Events</strong></p>
</div>
</div></section>

<!-- -->

<section class="slide"><div>
    <img src="pictures/pointer-events-funnel.png" alt="Graphic showing 'Pen', 'Touch' and 'Mouse' in a funnel">
    <p>unifies mouse, touch and pen input into a single event model</p>
</div></section>

<!-- -->

<section class="slide"><div>
    <img src="pictures/sites/msdn-channel9-build2014-building-xbox-one-apps.png" alt="XBox One exposes Kinect interactions in IE (single hand gestures only?) as Pointer Events">
    <p>...and some new inputs (though currently mapped to mouse)</p><p><a target="_blank" href="http://channel9.msdn.com/Events/Build/2014/2-647">Building Xbox One Apps using HTML and JavaScript</a></p><p><a target="_blank" href="https://www.youtube.com/watch?v=J0dgOodx-ew">YouTube: Xbox One Edge Browser sends Pointer Events</a></p>
</div></section>

<!-- -->

<section class="slide impact"><div>
<div>
    <p>not just some<br>“<strong>not invented here</strong>”<br>technology</p>
</div>
</div></section>

<!-- -->

<section class="slide"><div>
    <img src="pictures/sites/w3c-pointer-events-tr.png" alt="">
    <p>submitted by Microsoft as W3C Candidate REC 09 May 2013</p>
</div></section>

<!-- -->

<section class="slide"><div>
    <img src="pictures/sites/w3c-pointer-events.png" alt="">
    <p><a target="_blank" href="http://www.w3.org/TR/pointerevents">Pointer Events - W3C REC 24 February 2015</a></p>
</div></section>

<!-- -->

<section class="slide"><div>
    <img src="pictures/sites/w3c-pointer-events-level2-editors-draft.png" alt="">
    <p>work now continues to enhance/expand Pointer Events...</p>
    <p><a target="_blank" href="https://w3c.github.io/pointerevents/">W3C Pointer Events Level 2 (Editor's Draft)</a></p>
</div></section>

<!-- -->

<section class="slide"><div>
    <img src="pictures/sites/caniuse-pointer-events-current.png" alt="">
    <p><a target="_blank" href="http://caniuse.com/#search=pointer%20events">caniuse.com: Can I use <strong>pointer events</strong>?</a></p>
</div></section>

<!-- -->

<section class="slide"><div>
    <img src="pictures/sites/bugzilla-implement-pointer-events.png" alt="">
    <p><a target="_blank" href="https://bugzilla.mozilla.org/show_bug.cgi?id=822898">Bug 822898 - Implement pointer events</a></p>
</div></section>

<!-- -->

<section class="slide"><div>
    <img src="pictures/win10/firefox-about-config-pointer-events.png" alt="">
    <p><code>about:config / dom.w3c_pointer_events.enabled</code></p>
</div></section>

<!-- -->

<section class="slide impact"><div>
<div>
    <p>...what about <strong>Apple</strong>?</p>
</div>
</div></section>

<!-- -->

<section class="slide"><div>
    <img src="pictures/sites/html5labs-interoperabilitybridges.png" alt="">
    <p>Microsoft submitted a proof of concept WebKit patch</p>
    <p><a target="_blank" href="http://html5labs.interoperabilitybridges.com/prototypes/pointer-events-for-webkit/pointer-events-for-webkit/info">html5labs.interoperabilitybridges.com/prototypes/...</a></p>
</div></section>

<!-- -->

<section class="slide"><div>
    <img src="pictures/sites/webkit-bugzilla-implement-pointer-events-wontfix.png" alt="">
    <p><a target="_blank" href="https://bugs.webkit.org/show_bug.cgi?id=105463">Bug 105463 - Implement pointer events</a> <strong>RESOLVED WONTFIX</strong></p>
</div></section>

<!-- -->

<section class="slide"><div>
    <img src="pictures/sites/list-webkit-maciej-pointer-events.png" alt="">
    <p><a target="_blank" href="https://lists.webkit.org/pipermail/webkit-dev/2012-December/023050.html">Maciej Stachowiak - [webkit-dev] pointer events specification - first editors draft</a></p>
</div></section>

<!-- -->

<section class="slide"><div>
    <img src="pictures/sites/twitter-patrickhlauke-apple-pointer-events.png" alt="Tweet: 'this spec to easily support multi-input devices is rubbish' says hardware/software company with no multi-input devices">
    <p><a target="_blank" href="https://twitter.com/patrick_h_lauke/status/570522295317372928">@patrick_h_lauke paraphrasing Apple's stance on Pointer Events...</a></p>
</div></section>

<!-- -->

<section class="slide cover impact"><div>
    <img src="pictures/backgrounds/apple-pencil.jpg" class="cover" alt="Apple Pencil for iPad Pro advert">
</div></section>

<!-- -->

<section class="slide statement"><div>
<div>
    <p>Apple Pencil currently indistinguishable from touch in browser / JavaScript<br><small>(no tilt information, fires touch events)</small></p>
</div>
</div></section>

<!-- -->

<section class="slide impact"><div>
<div>
    <p>the anatomy of <strong>Pointer Events</strong><br><small>(sequence, event object, ...)</small></p>
</div>
</div></section>

<!-- -->

<section class="slide"><div>
    <img src="pictures/win10/ms-edge-event-sequence-no-timing.png" alt="Microsoft Edge / Windows 10 pointer events / mouse events sequence">
    <p><a target="_blank" href="https://patrickhlauke.github.io/touch/tests/event-listener_all-no-timings.html">patrickhlauke.github.io/touch/tests/event-listener_all-no-timings.html</a></p>
</div></section>

<!-- -->

<section class="slide code"><div>
    <h2>events fired on tap (Edge)</h2>
<pre><code class="json">mousemove* >
<mark>pointerover</mark> > mouseover >
<mark>pointerenter</mark> > mouseenter >
<mark>pointerdown</mark> > mousedown >
focus
<em>gotpointercapture</em> >
<mark>pointermove</mark> > mousemove >
<mark>pointerup</mark> > mouseup >
<em>lostpointercapture</em> >
click >
<mark>pointerout</mark> > mouseout >
<mark>pointerleave</mark> > mouseleave</code></pre>
<p>mouse events fired “inline” with pointer events<br><small>(for a primary pointer, e.g. first finger on screen)</small></p>
</div></section>

<!-- -->

<section class="slide listing"><div>
    <h2>IE10/IE11 quirks</h2>
    <ul>
    <li>vendor-prefixed in IE10 (<code>MSPointerDown</code> ..., <code>navigator.msMaxTouchPoints</code>, <code>-ms-touch-action</code>)</li>
    <li>unprefixed in IE11 (but prefixed versions mapped for compatibility)</li>
    <li>event order (when <code>click</code> is fired) incorrect in IE10/IE11<br>see <a target="_blank" href="http://lists.w3.org/Archives/Public/public-pointer-events/2014OctDec/0025.html">W3C Pointer Events WG mailing list - Jacob Rossi (Microsoft)</a></li>
</div></section>

<!-- -->

<section class="slide"><div>
    <img src="pictures/sites/w3c-github-pointerevents-compatibility-mapping-with-mouse-events-note.png" alt="Compatibility mapping note for devices that support both Pointer Events and Touch Events">
    <p><small>Chrome, Edge (on mobile), <a target=")_blank" href="https://blogs.msdn.microsoft.com/ie/2014/07/31/the-mobile-web-should-just-work-for-everyone/">IE11 (Windows Phone 8.1update1)</a> support<br><strong>both</strong> Touch Events and Pointer Events</small></p>
    <p><a target="_blank" href="https://w3c.github.io/pointerevents/#mapping-for-devices-that-do-not-support-hover">w3c.github.io/pointerevents/#mapping-for-devices-that-do-not-support-hover</a></p>
</div></section>

<!-- -->

<section class="slide"><div>
    <img src="pictures/win10mobile/win10mobile-edge15-pointer-touch.png" alt="Windows 10 Mobile / Edge with both touch and pointer events enabled shows different event order...">
    <p><a target="_blank" href="https://patrickhlauke.github.io/touch/tests/event-listener_all-no-timings.html">patrickhlauke.github.io/touch/tests/event-listener_all-no-timings.html</a></p>
</div></section>

<!-- -->

<section class="slide"><div>
    <img src="pictures/win10/ms-edge-about-flags-touch.png" alt="">
    <p><small><code>about:flags</code> in Microsoft Edge to turn on touch events on desktop<br>(e.g. touch-enabled laptops) – off by default for site compatibility</small></p>
</div></section>

<!-- -->

<section class="slide code"><div>
<h2>... when touch events also supported (Edge)</h2>
<pre><code class="json">pointerover > pointerenter > pointerdown >
<mark>touchstart</mark> >
pointerup >
<mark>touchend</mark> >
<mark>mouseover</mark> > <mark>mouseenter</mark> > <mark>mousemove</mark> > <mark>mousedown</mark> >
focus >
<mark>mouseup</mark> >
click >
pointerout > pointerleave</code></pre>
<p><small>Specific order of events is not defined in the spec in this case – will vary between browsers...<br>only problem if handling both pointer events and mouse events (which is nonsensical)</small></p>
</div></section>

<!-- -->

<section class="slide code"><div>
<pre><code class="js">/* Pointer Events <mark>extend</mark> Mouse Events
   vs Touch Events and their new objects / TouchLists / Touches */

interface PointerEvent : <mark>MouseEvent</mark> {
    readonly attribute long pointerId;
    readonly attribute long width;
    readonly attribute long height;
    readonly attribute float pressure;
    readonly attribute float tangentialPressure; /* Level 2 */
    readonly attribute long tiltX;
    readonly attribute long tiltY;
    readonly attribute long twist; /* Level 2 */
    readonly attribute DOMString pointerType;
    readonly attribute boolean isPrimary;
}

/* plus all MouseEvent attributes: <mark>clientX</mark>, <mark>clientY</mark>, etc */

</code></pre>
    <p><a target="_blank" href="http://www.w3.org/TR/pointerevents/#pointerevent-interface">www.w3.org/TR/pointerevents/#pointerevent-interface</a></p>
</div></section>

<!-- -->

<section class="slide statement"><div>
<div>
    <p>handling mouse input is exactly the same as traditional mouse events<br><small>(only change <code>pointer*</code> instead of <code>mouse*</code> event names)</small></p>
</div>
</div></section>

<!-- -->

<section class="slide statement"><div>
<div>
    <p>handling <strong>touch or stylus</strong> is <strong>also</strong> exactly the same as traditional mouse events<br><small>(mouse code can be adapted to touch/stylus quickly)</small></p>
</div>
</div></section>

<!-- -->

<section class="slide impact"><div>
<div>
    <p>simple <strong>feature detection</strong> for pointer events</p>
</div>
</div></section>

<!-- -->

<section class="slide code"><div>
<pre><code class="js">/* detecting pointer events support */

if (<mark>window.PointerEvent</mark>) {
    /* some clever stuff here but this covers
       touch, stylus, mouse, etc */
}

/* <mark>still listen to click for keyboard!</mark> */</code></pre>
</div></section>

<!-- -->

<section class="slide"><div>
    <img src="pictures/sites/w3c-pointer-events-kbd-note.png" alt="Keyboard-related note in W3C Pointer Events, referencing WCAG 2.0 Guideline 2.1">
    <p>"don't forget about keyboard users" note in Pointer Events spec</p>
</div></section>

<!-- -->

<section class="slide code"><div>
<pre><code class="js">/* detect maximum number of touch points */

if (<mark>navigator.maxTouchPoints > 0</mark>) {
    /* device with a touchscreen */
}

if (<mark>navigator.maxTouchPoints > 1</mark>) {
    /* multitouch-capable device */
}</code></pre>
<p>"you <strong>can</strong> detect a touchscreen"<br>...but user may still use other input mechanisms</p>
</div></section>

<!-- -->

<section class="slide"><div>
    <img src="pictures/sites/pointerevents-detect-chrome-mobile-desktop.png" alt="Chrome on Android and on a non-touch-enabled desktop, showing they both support Pointer Events, but only on Android it also registers navigator.maxTouchPoints greater than zero">
    <p><a target="_blank" href="https://patrickhlauke.github.io/touch/tests/pointer-multitouch-detect.html">patrickhlauke.github.io/touch/tests/pointer-multitouch-detect.html</a></p>
</div></section>

<!-- -->

<section class="slide statement"><div>
<div>
    <p>do pointer events fire during <strong>scroll</strong>/<strong>zoom</strong>?</p>
</div>
</div></section>

<!-- -->

<section class="slide"><div>
    <img src="pictures/sites/w3c-github-pointerevents-pointercancel-pan-zoom.png" alt="Non-normative note on situations when pointercancel is fired, including 'The user agent interprets the input as a pan or zoom gesture'">
    <p><a target="_blank" href="https://w3c.github.io/pointerevents/#the-pointercancel-event">w3c.github.io/pointerevents/#the-pointercancel-event</a></p>
</div></section>

<!-- -->

<section class="slide"><div>
    <img src="pictures/win10mobile/win10-edge-pointer-events-scroll.png" alt="">
    <p>once a browser handles scrolling, it sends <code>pointercancel</code></p>
    <p><a target="_blank" href="https://patrickhlauke.github.io/touch/gesture-touch/pointerevents.html">patrickhlauke.github.io/touch/gesture-touch/pointerevents.html</a></p>
</div></section>

<!-- -->

<section class="slide impact"><div>
<div>
    <p>pointer events<br><strong>vs</strong><br><strong>limitations</strong>/<strong>problems</strong> of mouse event emulation</p>
</div>
</div></section>

<!-- -->

<section class="slide statement listing"><div>
<div>
    <ol>
        <li>delayed event dispatch</li>
        <li>mousemove doesn't track</li>
    </ol>
</div>
</div></section>

<!-- -->

<section class="slide statement listing"><div>
<div>
    <ol>
        <li><strong>delayed event dispatch</strong></li>
        <li>mousemove doesn't track</li>
    </ol>
</div>
</div></section>

<!-- -->

<section class="slide"><div>
    <img src="pictures/winphone8/ie11-event-listener-all-after.png" alt="">
    <p><a target="_blank" href="https://patrickhlauke.github.io/touch/tests/event-listener.html">patrickhlauke.github.io/touch/tests/event-listener.html</a></p>(IE11/WinPhone 8.1 Update no optimization for <code>width=device-width</code>)
</div></section>

<!-- -->

<section class="slide"><div>
    <img src="pictures/win8/ie11-all-inc-timings2.png" alt="300ms delay happens only just before click event is fired - compare to touch events where the delay happens after touchend but before all mouse compatibility events">
    <p><a target="_blank" href="https://patrickhlauke.github.io/touch/tests/event-listener.html">patrickhlauke.github.io/touch/tests/event-listener.html</a></p><p><small>(IE/Win8 has double-tap to zoom, so problem on desktop too)</small></p>
</div></section>

<!-- -->

<section class="slide"><div>
    <img src="pictures/win10/ms-edge-event-sequence-showing-click-delay.png" alt="">
    <p><a target="_blank" href="https://patrickhlauke.github.io/touch/tests/event-listener.html">patrickhlauke.github.io/touch/tests/event-listener.html</a></p>
    <p><small>(Microsoft Edge/Win10 has double-tap to zoom, so problem on desktop too)</small></p>
</div></section>

<!-- -->

<section class="slide code"><div>
    <h2>pointer / mouse events and delay</h2>
<pre><code class="json">...
<mark>[300ms delay]</mark>
click
...</code></pre>
    <p>300ms delay just before <code>click</code> event</p>
</div></section>

<!-- -->

<section class="slide impact"><div>
<div>
    <p>“how can we make it feel <strong>responsive</strong> like a native app?”</p>
</div>
</div></section>

<!-- -->

<section class="slide statement"><div>
<div>
    <p>we <strong>could</strong> try a similar approach to touch events...</p>
</div>
</div></section>

<!-- -->

<section class="slide listing"><div>
    <ul>
    <li>double-up <code>pointerup</code> and <code>click</code> listeners?</li>
    <li>prevent code firing twice with <code>preventDefault</code>?</li>
    </ul>
    <p><strong>won't work:</strong> <code>preventDefault()</code> stops mouse compatibility events, but <code>click</code> is not considered mouse compatibility event</p>
</div></section>

<!-- -->

<section class="slide impact"><div>
<div>
    <p>a more declarative approach<br>with <code>touch-action</code></p>
</div>
</div></section>

<!-- -->

<section class="slide code"><div>
    <h2>CSS property</h2>
    <p>what action should the browser handle?</p>
    <pre><code class="css">
touch-action: auto | <mark>none</mark> | [ pan-x || pan-y ] | <mark>manipulation</mark></code></pre>
    <p><a target="_blank" href="http://www.w3.org/TR/pointerevents/#the-touch-action-css-property">www.w3.org/TR/pointerevents/#the-touch-action-css-property</a></p><p>only determines default touch action, does not stop compatibility mouse events nor <code>click</code></p>
</div></section>

<!-- -->

<section class="slide code"><div>
    <h2>Pointer Events Level 2</h2>
    <p>expanded set of values (useful for pull-to-refresh, carousels, etc)</p>
    <pre><code class="css">
touch-action: auto | none |
              [ [ pan-x | <mark>pan-left</mark> | <mark>pan-right</mark> ] ||
              [ pan-y | <mark>pan-up</mark> | <mark>pan-down</mark> ] ] |
              manipulation</code></pre>
    <p><a target="_blank" href="https://w3c.github.io/pointerevents/#the-touch-action-css-property">w3c.github.io/pointerevents/#the-touch-action-css-property</a></p>
</div></section>

<!-- -->

<section class="slide"><div>
    <img src="pictures/sites/compat-spec-whatwg-touch-action.png" alt="">
    <p><a target="_blank" href="https://compat.spec.whatwg.org/#touch-action">compat.spec.whatwg.org</a> add extra value <code>pinch-zoom</code></p>
</div></section>

<!-- -->

<section class="slide"><div>
    <img src="pictures/android/chrome-touch-action-scrolling.png" alt="">
    <p><a target="_blank" href="https://patrickhlauke.github.io/touch/touch-action-scrolling/">patrickhlauke.github.io/touch/touch-action-scrolling</a></p>
</div></section>

<!-- -->

<section class="slide statement"><div>
<div>
    <p><code>touch-action:none</code></p>
    <p><small>(suppress all default browser behaviour)</small></p>
</div>
</div></section>

<!-- -->

<section class="slide"><div>
    <img src="pictures/win10/ms-edge-events-touch-action-none.png" alt="Microsoft Edge/Windows 10 shows no click delay after tap on touchscreen with touch-action:none">
    <p><a target="_blank" href="https://patrickhlauke.github.io/touch/tests/event-listener_touch-action-none.html">patrickhlauke.github.io/touch/tests/event-listener_touch[...]</a></p>
</div></section>

<!-- -->

<section class="slide cover impact"><div>
    <div><p><code>touch-action:none</code> kills scrolling, long-press, pinch/zoom</p></div>
    <img src="pictures/backgrounds/background-danger-415-volts.jpg" class="cover" alt="">
</div></section>

<!-- -->

<section class="slide statement"><div>
<div>
    <p><code>touch-action:manipulation</code></p>
    <p><small>(suppress double-tap-to-zoom)</small></p>
</div>
</div></section>

<!-- -->

<section class="slide"><div>
    <img src="pictures/win10/ms-edge-events-touch-action-manipulation.png" alt="Microsoft Edge/Windows 10 shows no click delay after tap on touchscreen with touch-action:manipulation">
    <p><a target="_blank" href="https://patrickhlauke.github.io/touch/tests/event-listener_touch-action-manipulation.html">patrickhlauke.github.io/touch/tests/event-listener_touch[...]</a></p>
</div></section>

<!-- -->

<section class="slide"><div>
    <img src="pictures/sites/caniuse-touch-action.png" alt="">
    <p><a target="_blank" href="http://caniuse.com/#search=touch-action">caniuse.com: Can I use <strong>touch-action</strong>?</a></p>
</div></section>

<!-- -->

<section class="slide impact"><div>
<div>
    <p>browsers working to remove <strong>double-tap to zoom</strong> delay<br><small>(when page not zoomable)</small></p>
</div>
</div></section>

<!-- -->

<section class="slide"><div>
    <img src="pictures/winphone8/ie11-8.1u1-userscalable-no-no-delay.png" alt="IE11/Windows Phone 8.1u1 support for user-scalable=no and click delay suppression">
    <p><code class="html">&lt;meta name="viewport" content="user-scalable=no"></code></p>
    <p><a target="_blank" href="https://patrickhlauke.github.io/touch/tests/event-listener_user-scalable-no.html">patrickhlauke.github.io/touch/tests/event-listener_user-scalable-no.html</a></p>
</div></section>

<!-- -->

<section class="slide"><div>
    <img src="pictures/winphone8/settings-force-zoom.png" alt="Windows Phone 8's 'Allow zooming on all web content' setting to override unzoomable viewports">
</div></section>

<!-- -->

<section class="slide"><div>
    <img src="pictures/winphone8/ie11-8.1u1-userscalable-no-force-zoom-delay.png" alt="IE11/Windows Phone 8.1u1 set to 'Allow zooming' - 300ms delay just before click event returns even when user-scalable=no">
    <p>"Allow zooming on all web content" reintroduces delay</p>
    <p><a target="_blank" href="https://patrickhlauke.github.io/touch/tests/event-listener_user-scalable-no.html">patrickhlauke.github.io/touch/tests/event-listener_user-scalable-no.html</a></p>
</div></section>

<!-- -->

<section class="slide"><div>
    <img src="pictures/win10mobile/win10mobile-ease-of-access.png" alt="Windows 10 Mobile lacks 'Allow zooming on all web content' setting to override unzoomable viewports">
    <p>"Allow zooming..." option currently missing in Win 10 Mobile</p>
</div></section>

<!-- -->

<section class="slide"><div>
    <img src="pictures/sites/developer-microsoft-edge-changelog-mobile-zoom.png" alt="New web platform features announcement: On Windows 10 Mobile devices, the user can now zoom into the page regardless of zoom settings defined by meta viewport">
    <p><a target="_blank" href="https://developer.microsoft.com/en-us/microsoft-edge/platform/changelog/desktop/15007/">Windows 10 build 15007 on Mobile ignores unscalable viewports</a></p>
    <p>no delay <strong>until user zooms</strong> for first time...</p>
</div></section>

<!-- -->

<section class="slide"><div>
    <img src="pictures/winphone8/ie11-8.1u1-width-device-width-delay.png" alt="IE11/Windows Phone 8.1u1 - width=device-width has no effect on the 300ms delay">
    <p><code class="html">width=device-width</code> still has delay in IE11/WinPhone 8.1 Update</p>
    <p><a target="_blank" href="https://patrickhlauke.github.io/touch/tests/event-listener_width-device-width.html">patrickhlauke.github.io/touch/tests/event-listener_width-device-width.html</a></p>
</div></section>

<!-- -->

<section class="slide"><div>
    <img src="pictures/win10mobile/win10mob-edge-pointer-mouse-event-sequence-timings.png" alt="Microsoft Edge removes the 300ms delay for width=device-width">
    <p>Microsoft Edge removes delay for <code class="html">width=device-width</code></p>
    <p><a target="_blank" href="https://patrickhlauke.github.io/touch/tests/event-listener_width-device-width.html">patrickhlauke.github.io/touch/tests/event-listener_width-device-width.html</a></p>
</div></section>

<!-- -->

<section class="slide"><div>
    <img src="pictures/sites/patrickhlauke-github-touch-results-300ms-delay.png" alt="">
    <p><a target="_blank" href="https://patrickhlauke.github.io/touch/tests/results/#suppressing-300ms-delay">patrickhlauke.github.io/touch/tests/results/#suppressing-300ms-delay</a></p>
</div></section>

<!-- -->

<section class="slide statement listing"><div>
<div>
    <ol>
        <li>delayed event dispatch</li>
        <li><strong>mousemove doesn't track</strong></li>
    </ol>
</div>
</div></section>

<!-- -->

<section class="slide statement"><div>
<div>
    <p>just listen to <code>pointermove</code>...</p>
</div>
</div></section>

<!-- -->

<section class="slide impact"><div>
<div>
    <p>no need for <strong>separate</strong> mouse <strong>or</strong> touch event listeners</p>
</div>
</div></section>

<!-- -->

<section class="slide code"><div>
<pre><code class="js">/* touch events: separate handling */

foo.addEventListener('touchmove', ... , false);
foo.addEventListener('mousemove', ... , false);


/* pointer events: single listener for mouse, stylus, touch */

foo.addEventListener('<mark>pointermove</mark>', ... , false);</code></pre>
</div></section>

<!-- -->

<section class="slide impact"><div>
<div>
    <p>no need for <strong>separate</strong> mouse <strong>or</strong> touch code to get x / y coords</p>
</div>
</div></section>

<!-- -->

<section class="slide code"><div>
<pre><code class="js">/* Reminder: Touch Events need separate code for x / y coords */

function positionHandler(e) {
    <mark>if ((e.clientX)&amp;&amp;(e.clientY))</mark> {
        posX = e.clientX; posY = e.clientY;
    } <mark>else if (e.targetTouches)</mark> {
        posX = e.targetTouches[0].clientX;
        posY = e.targetTouches[0].clientY;
        ...
    }
}

canvas.addEventListener('mousemove', positionHandler, false );
canvas.addEventListener('touchmove', positionHandler, false );</code></pre>
</div></section>

<!-- -->

<section class="slide code"><div>
<pre><code class="js">/* Pointer Events <mark>extend</mark> Mouse Events */

foo.addEventListener('<mark>pointermove</mark>', function(e) {
    ...
    posX = <mark>e.clientX</mark>;
    posY = <mark>e.clientY</mark>;
    ...
}, false);</code></pre>
    <p><a target="_blank" href="http://www.w3.org/TR/pointerevents/#pointerevent-interface">www.w3.org/TR/pointerevents/#pointerevent-interface</a></p>
</div></section>

<!-- -->

<section class="slide"><div>
    <img src="pictures/win10/3drotator-mouse-only.png" alt="">
    <p><a target="_blank" href="https://patrickhlauke.github.io/touch/3d-jquery-rotator/">3D Rotator by Creative Punch</a></p>
    <p><small>coded to only use mouse events</small></p>
</div></section>

<!-- -->

<section class="slide"><div>
    <img src="pictures/win10/3drotator-mouse-pointerevents.png" alt="">
    <p><a target="_blank" href="https://patrickhlauke.github.io/touch/3d-jquery-rotator/index-pointerevents.html">3D Rotator modified to use Pointer Events</a></p>
    <p><small>minimal code changes, as Pointer Events extend mouse events</small></p>
</div></section>

<!-- -->

<section class="slide impact"><div>
<div>
    <p>but you can <strong>distinguish</strong><br>mouse <strong>or</strong> touch <strong>or</strong> stylus</p>
</div>
</div></section>

<!-- -->

<section class="slide code"><div>
<pre><code class="js">foo.addEventListener('pointermove', function(e) {
    ...
    switch(<mark>e.pointerType</mark>) {
        case '<mark>mouse</mark>':
              ...
              break;
        case '<mark>pen</mark>':
              ...
              break;
        case '<mark>touch</mark>':
              ...
              break;
        <mark>default</mark>: /* future-proof */
    }
    ...
} , false);</code></pre>
</div></section>

<!-- -->

<section class="slide impact"><div>
<div>
    <p>what about <strong>multitouch?</strong></p>
</div>
</div></section>

<!-- -->

<section class="slide code"><div>
<pre><code class="js">/* PointerEvents <mark>don't</mark> have the handy TouchList objects,
   so we have to replicate something similar... */

var points = [];
switch (e.type) {
    case '<mark>pointerdown</mark>':
          /* add to the array */
          break;
    case '<mark>pointermove</mark>':
          /* update the relevant array entry's x and y */
          break;
    case '<mark>pointerup</mark>':
    case '<mark>pointercancel</mark>':
          /* remove the relevant array entry */
          break;
}</code></pre>
</div></section>

<!-- -->

<section class="slide"><div>
    <img src="pictures/win10/ms-edge-tracker-pointer-hud-touch-mouse-surface3.png" alt="Touch and mouse used simultaneously, with extra information being displayed for each pointer (type, coordinates, whether it's a primary pointer, force, width, height">
    <p><a target="_blank" href="http://patrickhlauke.github.io/touch/tracker/multi-touch-tracker-pointer-hud.html">patrickhlauke.github.io/touch/tracker/multi-touch-tracker-pointer-hud.html</a></p>
    <p><small>(note multiple <code>isPrimary</code> pointers, per pointer type)</small></p>
</div></section>

<!-- -->

<section class="slide code"><div>
<pre><code class="js">/* like iOS/Safari, IE/Win has <mark>higher-level gestures</mark>,
   but these are <mark>not part of the W3C Pointer Events</mark> spec.

   Replicate these from basic principles again... */</code></pre>
   <p><a target="_blank" href="http://msdn.microsoft.com/en-gb/library/ie/hh673557(v=vs.85).aspx#Gesture_object_events">MSDN IE10 Developer Guide: Gesture object and events</a></p>
</div></section>

<!-- -->

<section class="slide impact"><div>
<div>
    <p>extended <strong>capabilities</strong><br><small>(if supported by hardware)</small></p>
</div>
</div></section>

<!-- -->

<section class="slide code"><div>
<pre><code class="js">/* Pointer Events - pressure */

interface PointerEvent : MouseEvent {
    readonly attribute long pointerId;
    readonly attribute long width;
    readonly attribute long height;
    readonly attribute float <mark>pressure</mark>;
    readonly attribute float tangentialPressure;
    readonly attribute long tiltX;
    readonly attribute long tiltY;
    readonly attribute long twist;
    readonly attribute DOMString pointerType;
    readonly attribute boolean isPrimary;
}
</code></pre>
<p><code>pressure</code>: value in range <code>0</code> – <code>1</code>. if no hardware support,<br><code>0.5</code> in active button state, <code>0</code> otherwise</p>
</div></section>

<!-- -->

<section class="slide"><div>
    <img src="pictures/win10/surface-ms-edge-stylus-hover-pressure.jpg" alt="">
    <p><a target="_blank" href="https://patrickhlauke.github.io/touch/tracker/multi-touch-tracker-pointer.html">patrickhlauke.github.io/touch/tracker/...</a></p>
    <p><a target="_blank" href="https://www.youtube.com/watch?v=5c7eT3ixbFM">YouTube: Touch tracker with Surface 3 pen</a></p>
</div></section>

<!-- -->

<section class="slide listing"><div>
    <h2>hovering stylus</h2>
    <ul>
    <li>hardware-dependant</li>
    <li><code>pointermove</code> fires</li>
    <li><code>pressure == 0</code> (non-active button state)</li>
    <li>track <code>pointerdown</code>/<code>pointerup</code> to be safe</li>
    </ul>
</div></section>

<!-- -->

<section class="slide code"><div>
<pre><code class="js">/* Pointer Events - contact geometry */

interface PointerEvent : MouseEvent {
    readonly attribute long pointerId;
    readonly attribute long <mark>width</mark>;
    readonly attribute long <mark>height</mark>;
    readonly attribute float pressure;
    readonly attribute float tangentialPressure;
    readonly attribute long tiltX;
    readonly attribute long tiltY;
    readonly attribute long twist;
    readonly attribute DOMString pointerType;
    readonly attribute boolean isPrimary;
}
</code></pre>
    <p>if hardware can't detect contact geometry, either <code>0</code> or "best guess"<br>(e.g. for mouse/stylus, return <code>width</code> / <code>height</code> of <code>1</code>)</p>
</div></section>

<!-- -->

<section class="slide"><div>
    <img src="pictures/win10/pointer-events-width-height-surface3-touch-mouse-stylus.png" alt="In Microsoft Edge on Surface 3, touch pointers have accurate width/height based on contact geometry, while mouse and stylus have width/height of 1">
    <p><a target="_blank" href="http://patrickhlauke.github.io/touch/tracker/tracker-width-height.html">patrickhlauke.github.io/touch/tracker/tracker-width-height.html</a></p>
    <p><a target="_blank" href="https://www.youtube.com/watch?v=3DxDdZdQzZo">YouTube: Pointer Events width and height ...</a></p>
</div></section>

<!-- -->

<section class="slide code"><div>
<pre><code class="js">/* Pointer Events - tilt */

interface PointerEvent : MouseEvent {
    readonly attribute long pointerId;
    readonly attribute long width;
    readonly attribute long height;
    readonly attribute float pressure;
    readonly attribute float tangentialPressure;
    readonly attribute long <mark>tiltX</mark>;
    readonly attribute long <mark>tiltY</mark>;
    readonly attribute long twist;
    readonly attribute DOMString pointerType;
    readonly attribute boolean isPrimary;
}
</code></pre>
    <p><code>tiltX</code>/<code>tiltY</code>: value in degrees <code>-90</code> – <code>90</code>.<br>returns <code>0</code> if hardware does not support tilt</p>
</div></section>

<!-- -->

<section class="slide"><div>
    <img src="pictures/win10/ms-edge-pen-tracker.png" alt="">
    <p><a target="_blank" href="https://patrickhlauke.github.io/touch/pen-tracker/">patrickhlauke.github.io/touch/pen-tracker</a></p>
    <p><a target="_blank" href="https://www.youtube.com/watch?v=1VlQzagF8PA">YouTube: ...pen with tilt, pressure and hover support</a></p>
</div></section>

<!-- -->

<section class="slide"><div>
    <img src="pictures/android/chrome-samsung-galaxy-note-4-stylus.jpg" alt="">
    <p><a target="_blank" href="https://patrickhlauke.github.io/touch/pen-tracker/">patrickhlauke.github.io/touch/pen-tracker</a></p>
    <p><a target="_blank" href="https://www.youtube.com/watch?v=S8dTUMhiOh0&t=27">YouTube: Chrome on Samsung Galaxy Note 4 - Pointer Events and stylus</a></p>
</div></section>

<!-- -->

<section class="slide statement"><div>
<div>
    <p><code>pointermove</code> fires if <strong>any property</strong> changes,<br> not just x/y position<br><small>(<code>width</code>, <code>height</code>, <code>tiltX</code>, <code>tiltY</code>, <code>pressure</code>)</small></p>
</div>
</div></section>

<!-- -->

<section class="slide impact"><div>
<div>
    <p>pointer events as the <strong>future</strong>?</p>
</div>
</div></section>

<!-- -->

<section class="slide statement"><div>
<div>
    <p><strong>transitional</strong> event handling<br>
    <small>(until all browsers support pointer events)</small></p>
</div>
</div></section>

<!-- -->

<section class="slide code"><div>
<pre><code class="js">/* cover all cases (hat-tip Stu Cox) */

if (window.PointerEvent) {

    /* bind to Pointer Events: pointerdown, pointerup, etc */

} else {

    /* bind to mouse events: mousedown, mouseup, etc */

    if ('ontouchstart' in window) {
        /* bind to Touch Events: touchstart, touchend, etc */
    }
}

/* bind to keyboard / click  */</code></pre>
</div></section>

<!-- -->

<section class="slide impact"><div>
<div>
    <p><strong>polyfills</strong> for pointer events<br>
    <small>(code for tomorrow, today)</small></p>
</div>
</div></section>

<!-- -->

<section class="slide"><div>
    <img src="pictures/sites/github-jquery-pep.png" alt="">
    <p><a target="_blank" href="https://github.com/jquery/PEP">GitHub - jQuery Pointer Events Polyfill (PEP)</a></p>
</div></section>

<!-- -->

<section class="slide code"><div>
<pre><code class="html">/* adding jQuery PEP */

&lt;script src="https://code.jquery.com/pep/0.4.1/pep.js">&lt;/script>

/* need to use custom touch-action <strong>attribute</strong>, not CSS (yet) */

&lt;button <mark>touch-action="none"</mark>>...&lt;/div></code></pre>
</div></section>

<!-- -->

<section class="slide"><div>
    <img src="pictures/ios8/safari-pep.png" alt="A pointer events demo running in iOS/Safari thanks to PEP">
    <p><a target="_blank" href="https://patrickhlauke.github.io/touch/pep-draw/">patrickhlauke.github.io/touch/pep-draw</a></p>
</div></section>

<!-- -->

<section class="slide"><div>
    <img src="pictures/ios9/safari-ios-event-listener-pep.png" alt="Event listener with PEP, running in iOS9/Safari">
    <p><a target="_blank" href="http://patrickhlauke.github.io/touch/pep/listener/event-listener.html">patrickhlauke.github.io/touch/pep/listener/event-listener.html</a></p>
</div></section>

<!-- -->

<section class="slide impact"><div>
<div>
    <p><strong>debugging</strong>/<strong>testing</strong></p>
</div>
</div></section>

<!-- -->

<section class="slide"><div>
    <img src="pictures/backgrounds/photo-device-testing.jpg" alt="Large number of mobile phone/tablet test devices">
    <p>nothing beats having real devices...</p>
</div></section>

<!-- -->

<section class="slide"><div>
    <img src="pictures/win10/chrome-devtools-device-mode-pointer-events.png" alt="">
    <p><a target="_blank" href="https://developers.google.com/web/tools/chrome-devtools/device-mode/">Chrome DevTools / Device Mode &amp; Mobile Emulation</a></p>
    <p>correctly emulates touch and pointer events</p>
</div></section>

<!-- -->

<section class="slide"><div>
    <img src="pictures/win10/firefox-devtools-responsive-mode-touch-events.png" alt="">
    <p><a target="_blank" href="https://developer.mozilla.org/en-US/docs/Tools/Responsive_Design_Mode">Firefox Developer Tools > Responsive Design Mode</a></p>
    <p>correctly emulates touch events</p>
</div></section>

<!-- -->

<section class="slide"><div>
    <img src="pictures/win10/edge-F12-emulation-no-touch.png" alt="">
    <p>no touch emulation, nor touch events + pointer events (like on real Windows 10 Mobile) emulation, in Edge/F12 Tools</p>
</div></section>

<!-- -->

<section class="slide"><div>
    <img src="pictures/osx/safari-responsive-design-mode-no-touch.png" alt="">
    <p>no touch emulation in Safari "Responsive Design Mode"</p>
</div></section>

<!-- -->

<section class="slide" id="yougotthetouch"><div>
    <img src="pictures/backgrounds/you-got-the-touch.jpg" alt="">
    <p><a target="_blank" href="https://www.youtube.com/watch?v=AZKpByV5764">youtube.com/watch?v=AZKpByV5764</a></p>
</div></section>

<!-- -->

<section class="slide"><div>
    <h2>get in touch</h2>
    <p><a target="_blank" href="https://twitter.com/patrick_h_lauke">@patrick_h_lauke</a><br>
    <a target="_blank" href="https://github.com/patrickhlauke/touch">github.com/patrickhlauke/touch</a><br>
    <a target="_blank" href="https://patrickhlauke.github.io/getting-touchy-presentation/">patrickhlauke.github.io/getting-touchy-presentation</a><br>
    <a target="_blank" href="http://www.slideshare.net/redux">slideshare.net/redux</a><br>
    <a target="_blank" href="http://www.paciellogroup.com">paciellogroup.com</a><br>
    <a target="_blank" href="http://www.splintered.co.uk">splintered.co.uk</a><p>
    <p><img src="pictures/cc-by-nc-sa.png" alt="Creative Commons: Attribution Non-Commercial Share-Alike"></p>
</div></section>

    <!--
        To hide progress bar from entire presentation
        just remove “progress” element.
        -->
    <div class="progress"></div>
    <script src="shower/shower.min.js"></script>
</body>
</html>